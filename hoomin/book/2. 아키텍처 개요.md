# 아키텍처 개요

## 네 개의 영역

- 표현 (UI)
    - Controller
    - 사용자의 요청을 받아 응용 영역에 전달, 응용영역 처리 결과 보여줌
- 응용
    - Service
    - 기능 구현 (주문 등록, 상품 상세 조회)
    - 도메인 모델을 사용해 기능 구현 
    - 로직을 직접 수행하기보다는 도메인 모델에 로직 수행을 위임
- 도메인
    - 도메인 로직을 구현
    - 핵심 로직을 구현
- 인프라스트럭처
    - 구현 기술
    - rdbms 연결, mq, redis, rest api 호출
    - 논리적인 개념을 표현하기보다는 실제 구현

## 계층 구조 아키텍처

- 표현 -> 응용 -> 도메인 -> 인프라스트럭처
    - 상위 계층에서 하위 계층으로의 의존만 존재하고 하위 계층은 상위 계층에 의존하지 않는다.
    - 엄격하게 적용한다면 상위 계층은 바로 아래의 계층에만 의존을 가져야 하지만 편리함을 위해 유연하게 적용하기도 한다.
        - 규모가 커질수록 엄격하게 통일 vs 더 유연하게 가자
- 인프라 스트럭처 계층에 종속되기 때문에 DIP 적용 필요

## DIP

> https://shinsunyoung.tistory.com/82
- 이상적으로는 모든 설계에 인터페이스를 부여하자
- 실무 고민
    - 하지만 인터페이스를 도입하면 추상화라는 비용이 발생한다.
    - 기능을 확장할 가능성이 없다면, 구체 클래스를 직접 사용하고, 향후 꼭 필요할 때 리팩터링해서 인터페이스를 도입하는 것도 방법이다.
    
## 도메인 영역의 주요 구성요소

- Entity
    - 도메인 관점에서 기능 구현, 캡슐화해 데이터가 임의로 변경되는 것을 막는다.
- Value
    - 데이터 변경할 때는 새로운 객체로 교체한다.
- Aggregate
    - 설계에 따라 구현이 복잡해지기도 하고, 트랜잭션 범위가 달라지기도 한다.
- Repository
    - 에그리거트 단위로 도메인 객체를 저장하고 조회하는 기능을 정의
- Domain Service
    - 할인 금액 계산은 상품, 쿠폰, 회원 드급, 구매 금액 등 다양한 조건을 이용해서 구현하게 되는데, 이렇게 도메인 로직이
    여러 Entity와 Value를 필요로 하면 도메인 서비스에서 로직을 구현한다.
  