# 9.1 도메인 모델과 경계

- 카탈로그에서의 상품 / 재고 관리에서의 상품 / 주문에서의 상품 / 배송에서의 상품 <- 이름만 같지 실제로 의미하는 것이 다르다.
- 이렇게 하위 도메인 마다 같은 용어라도 의미가 다르고 같은 대상이라도 지칭하는 용어가 다를 수 있다. -> 한 개의 모델로 모든 하위 도메인을 표현할 수 없다.
- **따라서 하위 도메인마다 사용하는 용어가 다르기 때문에 올바른 도메인 모델을 개발하려면 하위 도메인마다 모델을 만들어야 한다.**
- 각 모델은 명시적으로 구분되는 경계를 가져서 섞이지 않도록 해야 한다.
- -> 모델은 특정한 컨텍스트(문맥) 하에서 완전한 의미를 갖는다.
- 위의 `~ 에서의 상품` 에서 상품의 의미는 서로 다르다.
- 이렇게 구분되는 경계를 갖는 컨텍스트를 DDD 에서는 바운디드 컨텍스트 라고 부른다.

# 9.2 바운디드 컨텍스트

- 한개의 바운디드 컨텍스트는 논리적으로 한 개의 모델을 갖는다.
- 이상적으로 하위 도메인과 바운디드 컨텍스트가 일대일 관계를 가지면 좋지만 현실을 그렇지 않을 때가 많다.
- 하나의 하위도메인에 여러 컨텍스트가 존재할 수도 있고, 여러 도메인에서 하나의 바운디드 컨텍스트를 구현하기도 한다. (의미가 다르다면 따로 구현, 의미가 갖다면 하위 도메인이 여러개더라도 하나의 바운디드 컨텍스트에 구현)

- 규모가 작은 기업은 하나의 바운디드 컨텍스트 안에 여러 하위 도메인을 구현하기도 한다.
  - 여러 하위 도메인을 하나의 바운디드 컨텍스트에서 개발할 때 주의할 점
    - 하위도메인의 모델이 섞이지 않도록 한다. -> 하위 도메인 마다 구분되는 패키지를 갖도록 구현해야 한다.
    - 이렇게 하면 하위 도메인 마다 바운디드 컨텍스트를 갖는 효과를 낼 수 있다.

- 바운디드 컨텍스트는 도메인 모델을 구분하는 경계가 되기 때문에 바운디드 컨텍스트는 구현하는 하위 도메인에 알맞은 모델을 포함한다. [그림 9.4]

# 9.3 바운디드 컨텍스트 구현
- 바운디드 컨텍스트는 도메인 모델만 포함하지 않고 도메인 기능을 사용자에게 제공하는 데 필요한 표현 영역, 응용 서비스, 인프라스트럭처 영역을 모두 포함한다 (DBMS 까지).
- 각 바운디드 컨텍스트는 도메인에 알맞은 아키텍처를 사용한다.
- 한 다운디드 컨텍스트에 CQRS 를 적용하여 여러 방식의 기능을 혼합해서 사용할 수 있다. (쓰기, 조회)
- 바운디드 컨텍스트는 UI 를 갖지 않을 수도 있다. (JSON 데이터를 알맞게 가공, 여러 컨텍스트에서 제공하고 조합하여 UI 를 만든다.)

# 9.4 바운디드 컨텍스트 간 통합
- 두 바운디드컨텍스트간의 도메인이 연계가있을지라도 다른 도메인모델을구현한다

- 직접통합방식
  - api를이용하여 연계된도메인의정보를받아오고, 이를 내도메인모델로변환하여 비즈니스로직을 처리한다.
- 간접통합방식
  - 메시지큐를이용한방식 
  - 큐 제공자의 도메인모델에 맞춰서 서비스하기때문에구독하는컨텍스트가 자신의모델로변환하는작업이필요하다

# 9.5 바운디드 컨텍스트 간 관계
- 바운디드 컨텍스트 간은 어떤식으로든 연결됨
- API 호출부 (하류) / API 응답부 (상류)
- 상류 컴포넌트는 하류 컴포넌트에게 서비스 공급자 역할을 맡는다.
- 상류 팀과 하류팀은 개발일정을 맞춰서 개발해야 함. (상류 팀의 API 가 변경되면 하류 팀의 개발하지 못할 수 있음.)
- 공유 호스트 서비스
  - ex) 검색기능
  - 상류 컴포넌트서비스는 상류 바운디드 컨텍스트 모델을 따른다. -> 하류 컴포넌트는 상류 서비스의 모델이 자신의 모델에 영향을 주지 않도록 보호해주는 완충지대를 만들어야 한다.
  - 외부 시스템의 도메인 모델이 내도메인 모델을 침범하지 않도록 막아주는 역할을 한다. (ex : RecSystemClient)

- 공유 커널
  - 바운디드컨텍스트가 같은 모델을 공유한다.
  - 중복되는 모델을 공유한다.
  - 중복을 줄여준다.
  - 한팀에서 공유 모델을 수정할 경우 다른팀에 문제가 생길 수 있다.

- 독립 방식
  - 두 바운디드 컨텍스트는 수동으로 통합되어야 함.
  - 서비스가 커지면 수동으로 통합하기 힘들기 때문에 두 바운디드 컨텍스트를 통합시킨다.


# 9.6 컨텍스트 맵

- 비즈니스를 조망할 지도
- 시스템의 전체 구조를 보여준다.
- 하위도메인과 조직 구조를 함꼐 표현하면 전체를 이해하기 더 쉽다.
- 그림만 봐도 바운디드 컨텍스트 경계가 명확하고 서로간의 관계를 바로 알 수 있다.
- 사업의 핵심 도메인에 맞는 바운디드 컨텍스트에 집중할 수 있다.
