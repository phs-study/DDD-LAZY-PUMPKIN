# 6.1 표현 영역과 응용 영역
- 표현 영역 : 사용자와 상호작용
- 응용 영역 : 사용자가 원하는 기능을 제공
- 사용자와 상호작용은 표현 영역이 처리하기 때문에 응용 서비스는 표현 영역에 의존하지 않는다.

# 6.2 응용 서비스의 역할
- 응용 서비스 
  - 도메인 객체를 사용해서 사용자의 요청을 처리함.
  - 도메인 객체 간의 흐름을 제어한다.
  - 트랜잭션 처리를 담당한다. 
    - 트랜잭션 범위 안에서 응용 서비스를 실행해야 한다.
- 응용 서비스가 복잡하다면 응용서비스에서 도메인 로직의 일부를 구현하고 있을 가능성이 높다.
  - 코드 중복, 로직 분산 등 코드 품질에 안좋은 영향을 줄 수 있다.

## 6.2.1 도메인 로직 넣지 않기
도메인 영역에 로직을 넣으면 다음과 같은 문제가 생긴다.
- 코드의 응집성이 떨어진다.
  - 도메인 로직을 파악하기 위해 여러 영역을 분석해야 한다.
- 여러 응용 서비스에서 동일한 도메인 로직을 구현할 가능성이 높아진다.
  - 코드 중복이 발생한다.

# 6.3 응용 서비스의 구현
## 6.3.1 응용 서비스의 크기
응용 서비스 구현 방식
- 한 응용 서비스 클래스에 특정 도메인의 모든 기능 구현하기
  - 장점 : 동일한 로직을 사용하여 코드 중복을 제거하기 쉽다.
  - 단점 : 한 서비스의 크기가 커진다. 관련 없는 코드가 뒤섞여서 코드를 이해하는데 방해가 된다.
- 구분되는 기능별로 응용 서비스 클래스를 따로 구현하기
  - 장점 : 코드 품질을 일정 수준으로 유지하는 데 도움이 된다. 각 클래스 별로 필요한 의존 객체만 포함하므로 다른 기능을 구현한 코드에 영향을 받지 않는다.
  - 단점 : 클래스 개수가 많아진다.
  - 동일한 로직이 여러 클래스에 중복으로 구현될 경우 Helper 혹은 util 와 같은 별도 클래스에 로직을 구현해서 코드 중복을 방지할 수 있다.

기능별로 서비스 클래스를 따로 구현하는 방식이 좀 더 선호 되는 방식이 아닌가..

## 6.3.2 응용 서비스의 인터페이스와 클래스
- 응용 서비스의 경우 런타임에 구현체를 교체하는 경우가 거의 없다.
- 응용 서비스의 구현 클래스가 2개 이상인 경우가 거의 없다.
- 따라서 응용 서비스에 대한 인터페이스를 작성하는 것이 좋은 선택이라고 볼 수 없다.

## 6.3.3 메서드 파라미터와 값 리턴
- 응용 서비스에 데이터로 전달할 요청 파라미터가 두 개 이상 존재하면 데이터 전달을 위한 별도 클래스를 사용하는 것이 편리하다.
- 응용 서비스는 표현 영역에서 필요한 데이터만 리턴하는 것이 기능 실행 로직의 응집도를 높이는 확실한 방법이다.

## 6.3.4 표현 영역에 의존하지 않기
- 응용 서비스의 파라미터 타입으로 표현 영역과 관련된 타입을 사용하면 안된다. (ex : HttpServletRequest)
  - 이를 지키지 못하면 응용 서비스만 단독으로 테스트하기 어려워 진다.
  - 표현 영역의 역할을 대신하게 될 가능성이 높아진다.
    - 표현 영역의 응집도가 꺠지고 코드 유지 보수 비용을 증가시키는 원인이 된다.

## 6.3.5 트랜잭션 처리
- 트랜잭션을 통해 응용서비스의 중요한 역할을 해결해야 한다.
- 프레임워크가 제공하는 트랜잭션 기능을 적극 사용하는 것이 좋다.

# 6.4 표현 영역
1. 사용자가 시스템을 사용할 수 있는 흐름(화면)을 제공하고 제어한다.
2. 사용자의 요청을 알맞은 응용 서비스에 전달하고 결과를 사용자에게 제공한다.
3. 사용자의 세션을 관리한다.

# 6.5 값 검증
- 표현 영역과 응용 서비스 두 곳에서 모두 수행할 수 있다.
  - 원칙적으로 모든 값에 대한 검증은 응용 서비스에서 처리한다.
    - 단점 : 첫 번째 값이 옳바르지 않을 경우에 대한 에러만 표현 계층에 전달하므로 모든 값에서의 에러를 알 수 없다. -> error 를 모아서 표현 계층으로 넘겨주는 방식으로 해결해 줄 수 있음.
  - 표현 영역에서는 `필수 값` 에 대한 검증 방법도 있다.
    - 스프링 프레임워크는 Validator 인터페이스를 제공한다.

표현, 응용 영역에서 값 검증에 대한 역할을 나눌 수 있다.
- 표현 영역 : 필수 값, 값의 형식, 범위 등을 검증한다.
- 응용 영역 : 데이터의 존재 유무와 같은 논리적 오류를 검증한다.

응용 서비스에서 필요한 값과 논리적 검증을 모두 처리하게 되면 작성할 코드가 늘어난다.
하지만 응용 서비스의 완성도가 높아지는 이점이 있다.

# 6.6 권한 검사
보안 프레임워크 (Spring Security) 를 사용하거나 어플리케이션에 맞는 권한 검사 기능을 구현하는 것이 시스템 유지보수에 유리하다.

- 표현 영역
  - 인증된 사용자인지 아닌지 검사 (ex : 회원 정보 변경 기능)
  - 서블릿 필터를 통해서 접근 제어하기 편한다.
- 응용 서비스
  - 메서드 단위로 권한 검사를 수행한다.
  - ex : 스프링 시큐리티 AOP 를 이용하여 서비스 메서드에 대한 권한 검사 기능을 제공함. (`@PreAuthorize("hasRole('ADMIN')")`)
- 도메인
  - 개별 도메인 객체 단위로 권한 검사를 해야하는 경우 -> 로직이 복잡하다. (애그리거트를 로딩해야함.)
  - 스프링 시큐리티와 같은 보안 프레임워크를 확장 & 통합하여 구현할 수 있다. (but, 보안 프레임워크에 대한 높은 이해가 필요)

# 6.7 조회 전용 기능과 응용 서비스
- 조회 전용 기능을 통해 서비스 로직이 굳이 필요 없다면 **표현 영역**에서 바로 **조회 전용 기능**을 사용해도 상관 없다.
  - 굳이 서비스를 만들지 않아도 된다.
